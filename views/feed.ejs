<%- include('partials/header',{user:currentuser}); -%>

<div class="chatbox" id="chatbox" onclick="closePopup()">
  <div>
    <% allposts.forEach(function(post){ %>
    <div class="feed">

      <div class="user-profile-container">
        <div class="user-img">
          <img src="./uploads/<%=post.authordp%>" alt="">
        </div>

        <div class="user-info">
          <p class="user-name"><%=post.author%></p>
          <p class="user-bio">Currently Working At: <strong><%=post.authorg%></strong></p>
          <p class="user-bio">JGEC&nbsp&nbsp<%=post.authdept%>&nbsp'<%=post.authpassyear%></p>
        </div>
        <div class="post-time-div">
          <i class="fas fa-globe-asia"></i>
          <p><%= post.posttime %></p>
        </div>

        <div onclick="displayEdit('<%=post.posttime%>'+'<%Math.random%>')" class="three-dots">
          <i class='bx bx-dots-horizontal-rounded'></i>
          <div class="outer-display-edit-div" id="<%=post.posttime%>">
            <div class="inner-display-edit-div">

              <div class="item">
                <div class="item-icon">
                  <i class="far fa-bookmark"></i>
                </div>
                <div class="item-contents">
                  <div>
                    <p>Save</p>
                    <p>Save for later</p>
                  </div>
                </div>
              </div>

              <div class="item">
                <div class="item-icon">
                  <i class="fas fa-link"></i>
                </div>
                <div class="item-contents">
                  <div>
                    <p>Copy link</p>
                  </div>
                </div>
              </div>
              <% if(post.poster===currentuser.username){ %>
              <div class="item">
                <div class="item-icon">
                  <i class="fas fa-pen"></i>
                </div>
                <div class="item-contents">
                  <div>
                    <p>Edit post</p>
                  </div>
                </div>
              </div>

              <div class="item">
                <div class="item-icon">
                  <i class="fas fa-trash-alt"></i>
                </div>
                <div class="item-contents">
                  <div>
                    <p>Delete post</p>
                  </div>
                </div>
              </div>

              <% }%>

            </div>
          </div>

        </div>

      </div>

      <div class="user-chatbox">
        <p class="user-chatbox-post"><%=post.post%></p>
      </div>


      <% if(post.posttype==="1"){ %>
      <div style="width: 100%; display: flex; align-items: center;">
        <div class="user-chatbox-document-container">
          <div class="user-chatbox-document-link" target="_blank" href="./uploads/<%=post.postfile%>">
            <div style="display: flex; align-items: center;">

              <div class="document-type__img">
                <!-- pdf -->
                <svg style="color: #f72929;" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-file-earmark-pdf-fill" viewBox="0 0 16 16">
                  <path d="M5.523 12.424c.14-.082.293-.162.459-.238a7.878 7.878 0 0 1-.45.606c-.28.337-.498.516-.635.572a.266.266 0 0 1-.035.012.282.282 0 0 1-.026-.044c-.056-.11-.054-.216.04-.36.106-.165.319-.354.647-.548zm2.455-1.647c-.119.025-.237.05-.356.078a21.148 21.148 0 0 0 .5-1.05 12.045 12.045 0 0 0 .51.858c-.217.032-.436.07-.654.114zm2.525.939a3.881 3.881 0 0 1-.435-.41c.228.005.434.022.612.054.317.057.466.147.518.209a.095.095 0 0 1 .026.064.436.436 0 0 1-.06.2.307.307 0 0 1-.094.124.107.107 0 0 1-.069.015c-.09-.003-.258-.066-.498-.256zM8.278 6.97c-.04.244-.108.524-.2.829a4.86 4.86 0 0 1-.089-.346c-.076-.353-.087-.63-.046-.822.038-.177.11-.248.196-.283a.517.517 0 0 1 .145-.04c.013.03.028.092.032.198.005.122-.007.277-.038.465z"/>
                  <path fill-rule="evenodd" d="M4 0h5.293A1 1 0 0 1 10 .293L13.707 4a1 1 0 0 1 .293.707V14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2zm5.5 1.5v2a1 1 0 0 0 1 1h2l-3-3zM4.165 13.668c.09.18.23.343.438.419.207.075.412.04.58-.03.318-.13.635-.436.926-.786.333-.401.683-.927 1.021-1.51a11.651 11.651 0 0 1 1.997-.406c.3.383.61.713.91.95.28.22.603.403.934.417a.856.856 0 0 0 .51-.138c.155-.101.27-.247.354-.416.09-.181.145-.37.138-.563a.844.844 0 0 0-.2-.518c-.226-.27-.596-.4-.96-.465a5.76 5.76 0 0 0-1.335-.05 10.954 10.954 0 0 1-.98-1.686c.25-.66.437-1.284.52-1.794.036-.218.055-.426.048-.614a1.238 1.238 0 0 0-.127-.538.7.7 0 0 0-.477-.365c-.202-.043-.41 0-.601.077-.377.15-.576.47-.651.823-.073.34-.04.736.046 1.136.088.406.238.848.43 1.295a19.697 19.697 0 0 1-1.062 2.227 7.662 7.662 0 0 0-1.482.645c-.37.22-.699.48-.897.787-.21.326-.275.714-.08 1.103z"/>                 
                </svg>

                <!-- xlsx -->
                <!-- <img src="/images/excel.png" alt="excel"> -->

                <!-- pptx -->
                <!-- <svg style="color: #fa4c17;" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-file-earmark-ppt-fill" viewBox="0 0 16 16">
                  <path d="M8.188 10H7V6.5h1.188a1.75 1.75 0 1 1 0 3.5z"/>
                  <path d="M4 0h5.293A1 1 0 0 1 10 .293L13.707 4a1 1 0 0 1 .293.707V14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2zm5.5 1.5v2a1 1 0 0 0 1 1h2l-3-3zM7 5.5a1 1 0 0 0-1 1V13a.5.5 0 0 0 1 0v-2h1.188a2.75 2.75 0 0 0 0-5.5H7z"/>
                </svg> -->

                <!-- docs -->
                <!-- <svg style="color:#3f3fe7;" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-file-earmark-word-fill" viewBox="0 0 16 16">
                  <path d="M9.293 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4.707A1 1 0 0 0 13.707 4L10 .293A1 1 0 0 0 9.293 0zM9.5 3.5v-2l3 3h-2a1 1 0 0 1-1-1zM5.485 6.879l1.036 4.144.997-3.655a.5.5 0 0 1 .964 0l.997 3.655 1.036-4.144a.5.5 0 0 1 .97.242l-1.5 6a.5.5 0 0 1-.967.01L8 9.402l-1.018 3.73a.5.5 0 0 1-.967-.01l-1.5-6a.5.5 0 1 1 .97-.242z"/>
                </svg> -->

              </div>

              <div class="document__name">
                <a href="./uploads/<%=post.postfile%>" target="_blank">Welding.pdf</a>
              </div>

              <div class="document__download-btn">
                <div style="height: 32px; width: 32px; border-radius: 50%; border: 2px solid #aebac1; display: flex; align-items: center; justify-content: center;">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download" viewBox="0 0 16 16">
                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>
                    <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>
                  </svg>
                </div>
              </div>

            </div>

          </div>

        </div>

      </div>
      <% }%>



      <div class="user-chatbox-image-container">
        <% if(post.posttype==="2"){ %>
        <img style="width:350px" src="./uploads/<%=post.postfile%>" alt="Attached Image">
        <% }%>
      </div>


      <% if(post.posttype==="4"){ %>
      <div class="user-chatbox-audio-container">
        <audio controls>
          <source src="./uploads/<%=post.postfile%>" type="audio/mpeg">
        </audio>
      </div>
      <% }%>


      <% if(post.posttype==="3"){ %>
      <div class="user-chatbox-video-container">
        <video width="400" height="300" controls>
          <source src="./uploads/<%=post.postfile%>" type="video/mp4">
        </video>
      </div>
      <% }%>


      <hr style="margin: 4px 0; border: 0; height: 1px;">

      <div class="comment-like-share">
        <form action="/addlike" method="post" onclick="submit()">
          <i class="bx bxs-like"></i>
          <span class="countLikes"></span>
          <span>Like</span>
        </form>
        <form action="/addcomment">
          <i class='bx bx-comment-detail'></i>
          <span id="countComment"></span>
          <span>Comment</span>
        </form>
        <!-- <div> <i class="fal fa-share"></i> <span id="countShare"></span> <span>Share</span></div> -->
      </div>


      <!--Start Comment Div-->

      <div class="start-comment">
        <div class="container-img">
          <!-- <img src="/images/<%=currentuser.dp%>" alt="_image"> -->
          <img src="/images/mongalmoy_img.jpg" alt="_image">
        </div>
        <div class="input-comment">
          <input type="text" name="inputComment">
          <div class="comment-img-emoji">
            <div class="comment-img"> <i class="far fa-smile"></i> </div>
            <div class="comment-emoji"> <i class="fas fa-image"></i> </div>
          </div>
        </div>
      </div>

    </div>
    <% }) %>

  </div>

</div>


<div class="post-box-container" id="sendFormDiv" onclick="closePopup()">

  <form action="/addpost" method="POST" enctype="multipart/form-data">
    <div class="post-heading">
      <div>
        <p>Create a post</p>

        <i class=' close-button bx bx-x' onclick="closeForm()"></i>
      </div>
    </div>

    <hr>

    <div class="post-name-img">
      <img src="./uploads/<%=currentuser.dp%>" alt="_image">
      <div class="post-name">
        <%=currentuser.name%>
      </div>
    </div>

    <div class="post-box-body">
      <textarea name="inputText" id="posttextarea" cols="50" rows="6" placeholder="What do you want to talk about?"
        onkeypress="handleInputTextChange()" onkeyup="handleInputTextChange()" onchange="handleInputTextChange()"></textarea>
    </div>


    <!-- <video id="video" width="380" height="280" playsinline autoplay></video>
    <button id="capture">Capture</button>
    <canvas id="canvas" width="380" height="280"></canvas> -->

    <div class="attach">
      
      <div class="attach-button-container">
        <div class="attach-button__items" style="margin: 0;" onclick="displayAllEmojies()">
          <i class='bx bxs-smile'></i>
        </div>

        <div class="emoji-icon-container" id="emoji-icon-container">
          <h3>Smileys</h3>
          <div class="emoji-icon-row">
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ˜€</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ˜„</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ˜</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ˜†</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ˜…</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ¤£</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ˜‚</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ™‚</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ™ƒ</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ˜‰</div>
          </div>

          <div class="emoji-icon-row">
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ˜Š</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ˜‡</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ¥°</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ˜</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ¤©</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ˜˜</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ˜—</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ˜š</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ˜™</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ¥²</div>
          </div>

          <div class="emoji-icon-row">
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ˜‹</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ˜›</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ˜œ</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ¤ª</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ¤‘</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ¤—</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ¤­</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ¤«</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ¤”</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ¤</div>
          </div>

          <div class="emoji-icon-row">
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ¤¨</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ˜</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ˜‘</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ˜¶</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ˜</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ˜’</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ™„</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ˜¬</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ˜®â€ğŸ’¨</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ¤¥</div>
          </div>

          <div class="emoji-icon-row">
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ˜Œ</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ˜”</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ˜ª</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ¤¤</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ˜´</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ˜·</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ¤’</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ¤•</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ¤¢</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ¤®</div>
          </div>

          <div class="emoji-icon-row">
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ¤§</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ¥µ</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ¥¶</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ¥´</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ˜µ</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ˜µâ€ğŸ’«</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ¤¯</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ¤ </div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ¥³</div>
            <div class="emoji-icon" onclick="appendEmojiToTextarea(event)">ğŸ¥¸</div>
          </div>

        </div>
      </div>

      
  
      <div class="attach-button-container" >
        <div class="attach-button__items" style="margin: 0;" onclick="dispalyAttachIcons()">
          <i class="far fa-paperclip"></i>
        </div>
      
        <div class="attach-icon-div" id="attachIcons">
          <ul>
    
            <!-- <li>
              <div onclick="handleCaptureButton()" id="start-camera" class="camera-holder">
                <i class="fas fa-camera"></i>
              </div>
              <span class="tooltip">Camera</span>
            </li> -->
    
            <li>
              <div onclick="handleAttachImage()" class="image-holder">
                <i class="fas fa-image"></i>
                <input class="input-file" type="file" name="postfile" accept=".png, .jpeg, .jpg,.jpe,.mp4">
              </div>
              <span class="tooltip">Image</span>
            </li>
    
            <li>
              <div onclick="handleAttachDocument()" class="document-holder">
                <i class="far fa-file"></i>
                <input class="input-file" type="file" name="postfile"
                  accept=".xlsx,.xls ,.doc, .docx,.ppt, .pptx,.txt,.pdf">
              </div>
              <span class="tooltip">Document</span>
            </li>
    
            <li>
              <div onclick="handleAttachAudio()" class="audio-holder">
                <i class="fas fa-headphones-alt"></i>
                <input class="input-file" type="file" name="postfile" accept=".mp3, .wav">
              </div>
              <span class="tooltip">Audio</span>
            </li>
    
          </ul>
    
        </div>
      </div>

      <div class="attach-send-button">
        <button type="submit"><i id="sendButton" class='bx bxs-send'></i></button>
      </div>

    </div>

  </form>
</div>


<div class="emoji-icon-div">

</div>



<div id="openStartDiv" class="start-post-div" onclick="closePopup()">

  <div class="post-body">

    <div class="start-post-img">
      <img src="./uploads/<%=currentuser.dp%>" alt="_userimage">
    </div>
    <div class="start-post-content">
      <input onfocus="openForm()" placeholder="Add a post">
    </div>

  </div>

</div>



<%- include('partials/footer'); -%>